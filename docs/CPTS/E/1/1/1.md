## Documentation & Reporting in Practice

La documentación y las habilidades de redacción son increíblemente beneficiosas en cualquier área de Information Technology o Information Security, y dominarlas puede ayudarnos a progresar rápidamente en nuestras carreras. Ser altamente técnico es excelente y esencial, pero sin habilidades blandas que respalden nuestras habilidades técnicas de pwning, no seremos tan efectivos, ya sea escribiendo políticas y procedimientos internos, documentación técnica, penetration test reports, u otros tipos de entregables para clientes.

No existe un enfoque único para la toma de notas y la preparación de informes, pero hay principios fundamentales que deben seguirse para tener éxito. Este módulo explorará diferentes estilos de herramientas para tomar notas, organizar nuestras evidencias en nuestra testing VM, redactar Executive Summaries para audiencias no técnicas y documentar Attack Chains y hallazgos técnicos. Intentamos proporcionar una fórmula genérica que cualquiera puede usar para lograr el éxito, además de consejos, trucos y mejores prácticas que hemos aprendido a lo largo de 25 años combinados en diversos roles técnicos de consultoría y gestión orientados al cliente.

Una consideración crucial para nosotros como testers es que un penetration test es una instantánea en el tiempo del estado de seguridad de la red objetivo. Debemos incluir una sección de resumen en nuestro informe que hable sobre el tipo de trabajo realizado, quién lo realizó, las direcciones IP de origen utilizadas en las pruebas y cualquier consideración especial (por ejemplo, pruebas realizadas de forma remota a través de VPN o desde un host dentro de la red del cliente). Este resumen también debe indicar que nuestras pruebas se realizaron durante un período específico y que cualquier cambio en los sistemas dentro del alcance y las vulnerabilidades resultantes no se capturarían en este informe. Podríamos indicar: "Todas las actividades de prueba se realizaron entre el 7 de enero de 2022 y el 19 de enero de 2022." También podríamos agregar una advertencia, como "Este informe representa una instantánea en el tiempo durante el período de prueba mencionado anteriormente, y Acme Consulting, LLC no puede dar fe del estado de los activos de información del cliente fuera de esta ventana de prueba."

---

## Documentation & Reporting in Practice

Podrías estar pensando "`este será un módulo aburrido.`" o "`¿cómo podríamos hacer un curso completo sobre este tema?`". Si bien la documentación y la elaboración de informes no son el tema más emocionante y ciertamente no tan satisfactorio como hacer pwn a una máquina o conseguir DA en un laboratorio o red del mundo real, son habilidades críticas para cualquiera en un rol de consultoría. A continuación, se presentan algunos ejemplos de momentos en nuestras carreras en los que una documentación ordenada y exhaustiva y la elaboración de informes detallados nos salvaron de lo que podría haber escalado en una situación bastante desagradable.

**Scenario 1 - The Case of an Exploding VM**

Durante un compromiso particularmente largo (casi un mes de External Penetration Test), inicié sesión para el día, y mi VM no se cargaba correctamente. Pasé un tiempo intentando recuperar el sistema de archivos, pero estaba completamente perdido. Afortunadamente, había estado tomando notas de proyecto excelentes y detalladas usando una copia local de OneNote en mi workstation base. Mi equipo en ese momento usaba una solución de almacenamiento compartido para todos los proyectos, y teníamos un script automatizado para sincronizar nuestros datos para compartir al final de las pruebas, tanto para QA como para propósitos de archivo. Siguiendo un consejo de un compañero de equipo más experimentado, había estado respaldando mis evidencias de prueba en este almacenamiento compartido al final de cada día laboral. Por lo tanto, una vez que construí una nueva VM (desde una plantilla que mantenía), todo lo que tenía que hacer era sincronizar mis datos del proyecto, y volví a las pruebas sin interrupciones. Si no hubiera estado siguiendo un proceso definido, el resultado podría haber sido catastrófico, perdiendo semanas de trabajo y potencialmente perdiendo un cliente para la empresa o incluso mi trabajo.

**Scenario 2 - Ping of Death**

Sabía que este Internal Penetration Test sería difícil desde la llamada inicial de alcance. Un miembro del equipo interno de IT del cliente era muy hostil y cuestionaba todo, sospechando de las habilidades del equipo y muy protector de un conjunto de servidores críticos (cuyas direcciones IP no estaban en el alcance de las pruebas). Durante la fase de enumeración de las pruebas, recibí un correo electrónico y una llamada del cliente pidiendo detener todas las pruebas, ya que habíamos derribado varios servidores críticos que eran sensibles a cualquier tipo de escaneo. Produje todos los datos de los registros, archivos de alcance y datos de escaneo en bruto con marcas de tiempo. Las direcciones IP de los hosts afectados estaban en mis escaneos, pero también estaban incluidas en el archivo de alcance, que el cliente había confirmado. En este caso, no había hecho nada mal, ya que estaba probando el alcance que me dieron (y confirmaron) y no había realizado actividades de prueba imprudentes. Sin embargo, aprendí una lección que agregué a mis procesos. Después de esto, me aseguré de pedir a los clientes una lista específica de cualquier dirección IP individual y nombres de host que deban ser excluidos explícitamente de cualquier escaneo u otra actividad de prueba. En esta situación, tenía una documentación sólida para respaldar qué actividades se habían realizado y la confirmación por escrito de los rangos de direcciones IP en el alcance por parte del cliente. Sin embargo, encontré una oportunidad para refinar aún más mis procesos y crecer como consultor.

**Scenario 3 - Slow as Molasses**

En este último ejemplo, estaba realizando un Internal Penetration Test en las oficinas centrales del cliente, sentado en un área de la oficina donde estaba el personal de IT. Detrás de mí estaba un administrador de red particularmente hostil que había sido escéptico sobre nuestras habilidades y herramientas desde la llamada inicial, afirmando que las pruebas de penetración anteriores de otras compañías habían ralentizado enormemente la red debido a testers inexpertos e imprudentes. Menos de 20 minutos después de comenzar las pruebas, este administrador de red envió correos electrónicos a toda la lista de distribución y vino a mi escritorio diciéndome que nuestros escaneos habían ralentizado la red y había bloqueado nuestras direcciones IP de origen. Luego realizamos un ejercicio de compartir nuestros resultados de escaneo, demostrando que habíamos seguido las mejores prácticas y nada de lo que habíamos hecho explicaría la ralentización de la red. Otro administrador, mientras tanto, determinó que el modo de depuración había sido habilitado en todos los dispositivos de red, lo que, combinado con los escaneos normales de Nmap, era suficiente para abrumar los dispositivos y causar ralentizaciones. Una vez que esto se deshabilitó, las pruebas continuaron sin problemas. En este caso, nuestra documentación respaldó nuestras acciones y obligó al cliente a investigar más a fondo. Si no hubiéramos tenido documentación (o esta fuera deficiente), entonces la culpa podría haber recaído fácilmente sobre nosotros, y podría haber afectado en gran medida la relación con el cliente y nuestra reputación.

Estas historias ilustran la importancia de una documentación sólida. Necesitamos poder justificar nuestras acciones y, si se nos pide, poder producir evidencia para que el cliente intente solucionar un problema. No es raro que cualquier problema de red durante una prueba de penetración se culpe al tester, independientemente de si es resultado de sus actividades. Queremos estar en una posición sólida para cubrirnos y asistir a nuestros clientes. Además, nunca queremos tener que rehacer pruebas después de perder evidencias o pedir más tiempo al cliente porque no fuimos diligentes en nuestra toma de notas y organización.

---

## About this Module

Hemos incluido una muestra de notebook de Obsidian y un ejemplo de Internal Penetration Test report (en formatos MS Word y PDF - contraseña del zip `hackthebox`) que se puede descargar desde la pestaña `Resources` en la parte superior derecha de esta o cualquier otra sección del módulo. Estos son excelentes recursos complementarios para mantener para ustedes mismos, pero también útiles para tener a mano mientras trabajan en el contenido.

Hay muchas oportunidades en este módulo para practicar las habilidades que se enseñan, pero ninguna de ellas es obligatoria para completar el módulo. Para obtener el mayor valor de este módulo, recomendamos (obviamente) tomar notas detalladas y usar los consejos y trucos para ver dónde puede haber agujeros o ineficiencias en sus procesos. Una vez que descubras esto, esperamos que encuentres formas de ser más productivo y reducir la carga de informes porque, seamos honestos, a nadie le gusta hacer informes; lo toleramos como un mal necesario. Una vez que hayas terminado con este módulo, vale la pena practicar estos consejos en compromisos del mundo real o, si aún no trabajas en un rol de consultoría, practicar tus habilidades de documentación y elaboración de informes contra objetivos de entrenamiento y laboratorios.

Incluimos un attack host preconfigurado y un pequeño laboratorio con este módulo que puedes usar para simular un Internal Penetration Test. Aprovecha esto y úsalo para practicar tanto como quieras hasta que te sientas cómodo identificando todos los hallazgos y desarrolles un estilo de documentación que se adapte a tu flujo de trabajo.

A lo largo del módulo, es posible que nos veas usar términos como "an internal" o "an external". En estos casos, nos referimos a un Internal Penetration Test o External Penetration Test, respectivamente.

Hemos intentado hacer este tema típicamente aburrido más atractivo de lo habitual, así que abróchense los cinturones. ¡Será un viaje salvaje por el agujero del conejo de la documentación y la elaboración de informes!